# Itinerary Agent (여행 일정 에이전트)

## 개요

Itinerary Agent는 TripMind의 핵심 여행 일정 생성 모듈로, 사용자의 요구사항을 분석하여 맞춤형 여행 일정을 생성하고 관리하는 지능형 에이전트입니다. LangGraph와 LangChain을 활용하여 구현되었으며, Anthropic의 Claude 3 Opus 모델을 기반으로 합니다.

## 주요 기능

- 사용자 요구사항 분석 및 여행 일정 생성
- 장소 검색 및 추천
- 구글 캘린더 연동
- 일정 공유 및 관리
- 세션 기반 상태 관리

## 기술적 구조

### 1. 핵심 컴포넌트

#### ItineraryAgentExecutor

- 여행 일정 에이전트의 핵심 실행기
- `process_prompt` 메서드를 통해 사용자 입력 처리
- 세션 기반의 상태 관리
- 오류 처리 및 복구 메커니즘 구현

#### Itinerary Graph

- LangGraph 기반의 상태 관리 그래프
- 노드 기반 일정 생성 흐름 제어
- 체크포인트 저장소를 통한 상태 유지

#### LLM 통합

- Anthropic Claude 3 Opus 모델 활용
- 환경 변수 기반 API 키 관리
- 모델 초기화 및 관리

### 2. 노드 구조

#### Itinerary Node

- 여행 일정 생성의 핵심 노드
- 사용자 요구사항 분석
- 일정 생성 및 관리

#### Ask Info Node

- 추가 정보 수집
- 사용자 선호도 파악
- 여행 요구사항 상세화

#### Place Search Node

- 장소 검색 및 추천
- 카카오 API 연동
- 장소 정보 수집

#### Calendar Node

- 구글 캘린더 연동
- 일정 등록 및 관리
- 일정 수정 및 삭제

#### Sharing Node

- 일정 공유 기능
- 공유 링크 생성
- 권한 관리

### 3. 상태 관리

#### ItineraryState

- 사용자 입력 관리
- 여행 정보 저장
  - 목적지
  - 기간
  - 여행자 수
  - 예산
  - 선호사항
  - 특별 요구사항
- 메시지 히스토리 유지
- 노드 전환 정보 관리
- 세션 컨텍스트 저장

### 4. 프롬프트 관리

- YAML 기반 프롬프트 템플릿
- 동적 프롬프트 생성
- 도구 및 기능 통합

## 기술적 장점

### 1. 확장 가능한 아키텍처

- 모듈식 노드 구조로 새로운 기능 쉽게 추가 가능
- 인터페이스 기반 설계로 다양한 LLM 모델 통합 용이
- 상태 관리 시스템을 통한 일관된 데이터 흐름

### 2. 고급 메모리 관리

- 세션 기반 메모리 시스템
- 대화 컨텍스트 유지
- 효율적인 상태 복원 메커니즘

### 3. 견고한 오류 처리

- 예외 상황 자동 감지 및 처리
- 상세한 로깅 시스템
- 사용자 친화적 오류 메시지

### 4. 최적화된 성능

- 비동기 처리 지원
- 효율적인 리소스 관리
- 빠른 응답 시간

## 사용 예시

```python
# 에이전트 초기화
executor = ItineraryAgentExecutor()

# 여행 일정 생성 요청
response = executor.process_prompt(
    prompt="서울에서 3일 여행 계획을 세워줘",
    session_id="user123",
    start_node="ask_info_node"
)

# 응답 처리
print(response["response"])
```

## 향후 개선 방향

### 1. 고급 일정 최적화

- 실시간 교통 정보 반영
- 날씨 기반 일정 조정
- 예산 최적화 알고리즘

### 2. 개인화 강화

- 사용자 선호도 학습
- 과거 여행 데이터 활용
- 맞춤형 추천 시스템

### 3. 통합 기능 확장

- 호텔 예약 시스템 연동
- 항공권 검색 및 예약
- 현지 투어 패키지 추천

### 4. 보안 강화

- 개인정보 보호 강화
- 접근 제어 시스템
- 데이터 암호화

## 개발 가이드라인

### 1. 코드 구조

- 모듈화된 설계 유지
- 명확한 인터페이스 정의
- 테스트 커버리지 유지

### 2. 프롬프트 관리

- YAML 템플릿 사용
- 버전 관리
- 문서화

### 3. 테스트

- 단위 테스트 작성
- 통합 테스트 구현
- 성능 테스트 수행

## 결론

Itinerary Agent는 TripMind의 핵심 컴포넌트로, 사용자의 요구사항을 분석하여 맞춤형 여행 일정을 생성하고 관리합니다. 확장 가능한 아키텍처와 견고한 오류 처리, 효율적인 상태 관리를 통해 안정적이고 사용자 친화적인 서비스를 제공합니다.
